## ğŸ”§ KHáº®C PHá»¤C Lá»–I JAVA GATEWAY

Lá»—i `PySparkRuntimeError: [JAVA_GATEWAY_EXITED]` xáº£y ra khi Java chÆ°a Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘Ãºng.

---

## âœ… GIáº¢I PHÃP

### **BÆ°á»›c 1: Kiá»ƒm tra Java Ä‘Ã£ cÃ i chÆ°a**

```powershell
java -version
```

**Náº¿u khÃ´ng cÃ i:** Táº£i JDK tá»« https://www.oracle.com/java/technologies/downloads/
- Chá»n **Java SE 11 LTS** hoáº·c cao hÆ¡n
- Chá»n **Windows x64 Installer**

---

### **BÆ°á»›c 2: Cáº¥u hÃ¬nh JAVA_HOME (náº¿u cáº§n)**

#### **CÃ¡ch 1: Tá»± Ä‘á»™ng (DÃ¹ng file fixed)**
File `spark_processor_fixed.py` sáº½ **tá»± Ä‘á»™ng tÃ¬m Java** vÃ  set JAVA_HOME.

```bash
python spark_processor_fixed.py
```

#### **CÃ¡ch 2: Thá»§ cÃ´ng (náº¿u cÃ¡ch 1 khÃ´ng hoáº¡t Ä‘á»™ng)**

**TrÃªn Windows PowerShell:**
```powershell
# Set JAVA_HOME
$env:JAVA_HOME = "C:\Program Files\Java\jdk-11.0.XX"  # Thay XX báº±ng version cá»§a báº¡n

# XÃ¡c nháº­n
echo $env:JAVA_HOME
```

**Hoáº·c set vÄ©nh viá»…n (Environment Variables):**
1. Má»Ÿ **Settings** > **System** > **Advanced system settings**
2. Click **Environment Variables**
3. ThÃªm variable má»›i:
   - **Variable name:** `JAVA_HOME`
   - **Variable value:** `C:\Program Files\Java\jdk-11.0.XX`
4. Restart PowerShell hoáº·c IDE

---

### **BÆ°á»›c 3: Cháº¡y Spark**

```bash
# CÃ¡ch 1: DÃ¹ng file fixed (tá»± Ä‘á»™ng tÃ¬m Java)
python spark_processor_fixed.py

# CÃ¡ch 2: DÃ¹ng file gá»‘c (sau khi set JAVA_HOME)
python spark_processor.py
```

---

## ğŸ¯ Lá»–I THÆ¯á»œNG Gáº¶P

| Lá»—i | NguyÃªn nhÃ¢n | Giáº£i phÃ¡p |
|-----|-----------|----------|
| `java: command not found` | Java chÆ°a cÃ i | CÃ i JDK 8+ |
| `JAVA_HOME` undefined | KhÃ´ng set env variable | Set JAVA_HOME |
| `Java gateway process exited` | Java version cÅ© | NÃ¢ng cáº¥p lÃªn Java 11+ |
| `Port number not sent` | Lá»—i startup Java | XÃ³a `HADOOP_HOME` env var |

---

## ğŸ“Š KIá»‚M TRA Cáº¤U HÃŒNH

Cháº¡y lá»‡nh nÃ y Ä‘á»ƒ xÃ¡c nháº­n:

```powershell
# 1. Kiá»ƒm tra Java
java -version

# 2. Kiá»ƒm tra JAVA_HOME
$env:JAVA_HOME

# 3. Kiá»ƒm tra Ä‘Æ°á»ng dáº«n Java
Get-ChildItem $env:JAVA_HOME

# 4. Test Spark (chá»‰ import)
python -c "from pyspark.sql import SparkSession; print('âœ… Spark OK')"
```

---

## ğŸ’¡ TIP

- File `spark_processor_fixed.py` **tÃ­ch há»£p sáºµn** auto-detect Java
- KhÃ´ng cáº§n set JAVA_HOME náº¿u Java náº±m trong PATH
- Náº¿u lá»—i váº«n tá»“n táº¡i, xÃ³a `HADOOP_HOME` environment variable
